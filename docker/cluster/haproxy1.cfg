global
      maxconn 4096

defaults
      mode http
      maxconn 2000
      timeout connect 5000
      timeout client 50000
      timeout server 50000

frontend mariadb
      bind *:3306
      mode tcp
      default_backend mariadb_cluster


backend mariadb_cluster
      balance source
      mode tcp
      option tcpka
      option mysql-check user haproxy
      server mariadb1 mariadb-node-1:3306
      server mariadb2 mariadb-node-2:3306
      server mariadb3 mariadb-node-3:3306
